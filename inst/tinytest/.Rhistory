# install(file.path("D:/D Desktop/Publications/ImageMagick-7.1.0-62-Q16-HDRI-x64-dll"))
# tinytex::install_tinytex()
# tinytex::tlmgr_install("unfonts-extra")
# tinytex::tlmgr_install("makeindex")
#  create("squarebrackets")
# Rcpp::Rcpp.package.skeleton("squarebrackets")
# set version ====
package_tarname <- "squarebrackets_0.0.0.9.tar.gz"
# document ====
Rcpp::compileAttributes("squarebrackets")
devtools::document("./squarebrackets")
# codetools checks:
codetools::checkUsagePackage("squarebrackets")
ns <- loadNamespace("squarebrackets") |> as.list(all.names = TRUE)
ns <- ns[!stringi::stri_detect(names(ns), fixed = ".__")]
checks <- sapply(ns, \(x) any(deparse(x) |> stringi::stri_detect(regex = "return")))
names(checks)[!checks] |> sort()
# set-up ====
setwd("D:/D Desktop/Publications/R package squarebrackets")
sessionInfo()
pkgs <- c("devtools", "roxygen2", "usethis", "rcmdcheck", "spelling", "tinytex",
"tinytest",
"Rcpp", "pkgdown", "tinytest")
for(i in pkgs) if(!requireNamespace(i))install.packages(i)
library(tinytest)
# install(file.path("D:/D Desktop/Publications/ImageMagick-7.1.0-62-Q16-HDRI-x64-dll"))
# tinytex::install_tinytex()
# tinytex::tlmgr_install("unfonts-extra")
# tinytex::tlmgr_install("makeindex")
#  create("squarebrackets")
# Rcpp::Rcpp.package.skeleton("squarebrackets")
# set version ====
package_tarname <- "squarebrackets_0.0.0.9.tar.gz"
# document ====
Rcpp::compileAttributes("squarebrackets")
devtools::document("./squarebrackets")
# tinytest::run_test_dir("./squarebrackets/inst/tinytest/generic2")
foo <- rcmdcheck::rcmdcheck("./squarebrackets")
foo
devtools::document("./squarebrackets")
devtools::build_manual(
"./squarebrackets", "./squarebrackets"
) # if this fails...:
# argument i ====
x <- 1:10
expect_equal(
sb_x(x, slice(1, 1-1i)),
x[1:length(x)]
)
expect_equal(
sb_x(x, slice(1, 2-1i)),
x[1:(length(x)-1)]
)
expect_equal(
sb_x(x, slice(2, 1-1i)),
x[2:length(x)]
)
# argument i ====
x <- 1:10
slice_start <- list(
1, 2, 1-1i, 2-1i
)
seq_start <- c(
1, 2, length(x), length(x) - 1
)
slice_end <- c(
1, 2, 1-1i, 2-1i
)
seq_end <- c(
1, 2, length(x), length(x) - 1
)
slice_by <- list(
1, -1, 2, -2, NULL
)
seq_by <- ifelse(seq_start > seq_end, -1, 1) * c(1, 2, 2, 2)
seq_by
seq_by <- ifelse(seq_start > seq_end, -1, 1) * c(1, , 2, 2)
seq_by <- ifelse(seq_start > seq_end, -1, 1) * c(1, 1, 2, 2)
seq_start > seq_end
i=1
j=1
k=1
# argument i ====
x <- 1:10
slice_start <- list(
1, 2, 1-1i, 2-1i
)
seq_start <- c(
1, 2, length(x), length(x) - 1
)
slice_end <- c(
1, 2, 1-1i, 2-1i
)
seq_end <- c(
1, 2, length(x), length(x) - 1
)
slice_by <- list(
1, -1, 2, -2, NULL
)
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * slice_by[[k]]
expect_equal(
sb_x(x, slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[seq(seq_start[i], seq_end[j], seq_by)]
)
slice_start[i]
slice_start <- c(
1, 2, 1-1i, 2-1i
)
expect_equal(
sb_x(x, slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[seq(seq_start[i], seq_end[j], seq_by)]
)
# argument i ====
x <- 1:10
slice_start <- c(
1, 2, 1-1i, 2-1i
)
seq_start <- c(
1, 2, length(x), length(x) - 1
)
slice_end <- c(
1, 2, 1-1i, 2-1i
)
seq_end <- c(
1, 2, length(x), length(x) - 1
)
slice_by <- list(
1, -1, 2, -2, NULL
)
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * slice_by[[k]]
expect_equal(
sb_x(x, slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[seq(seq_start[i], seq_end[j], seq_by)]
)
}
}
}
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * slice_by[[k]]
seq_start[i]
seq_end[j]
slice_by[[k]]
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * slice_by[[k]]
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
expect_equal(
sb_x(x, slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[seq(seq_start[i], seq_end[j], seq_by)]
)
}
}
}
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * slice_by[[k]]
is.null(slice_by[[k]]
)
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
seq(seq_start[i], seq_end[j], seq_by)
slice(slice_start[i], slice_end[j], slice_by[[k]])
# set-up ====
setwd("D:/D Desktop/Publications/R package squarebrackets")
sessionInfo()
pkgs <- c("devtools", "roxygen2", "usethis", "rcmdcheck", "spelling", "tinytex",
"tinytest",
"Rcpp", "pkgdown", "tinytest")
for(i in pkgs) if(!requireNamespace(i))install.packages(i)
library(tinytest)
# install(file.path("D:/D Desktop/Publications/ImageMagick-7.1.0-62-Q16-HDRI-x64-dll"))
# tinytex::install_tinytex()
# tinytex::tlmgr_install("unfonts-extra")
# tinytex::tlmgr_install("makeindex")
#  create("squarebrackets")
# Rcpp::Rcpp.package.skeleton("squarebrackets")
# set version ====
package_tarname <- "squarebrackets_0.0.0.9.tar.gz"
# document ====
Rcpp::compileAttributes("squarebrackets")
devtools::document("./squarebrackets")
# argument i ====
x <- 1:10
slice_start <- c(
1, 2, 1-1i, 2-1i
)
seq_start <- c(
1, 2, length(x), length(x) - 1
)
slice_end <- c(
1, 2, 1-1i, 2-1i
)
seq_end <- c(
1, 2, length(x), length(x) - 1
)
slice_by <- list(
1, -1, 2, -2, NULL
)
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * slice_by[[k]]
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
expect_equal(
sb_x(x, slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[seq(seq_start[i], seq_end[j], seq_by)]
)
}
}
}
slice(slice_start[i], slice_end[j], slice_by[[k]])
seq_start[i], seq_end[j], seq_by)
seq(seq_start[i], seq_end[j], seq_by)
seq_start[i] > seq_end[j]
slice_start[i]
slice_end[j]
slice_by[[k]]
seq_by
seq_start[i] > seq_end[j]
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * slice_by[[k]]
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
!is.null(slice_by[[k]])
slice_by[[k]]
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * abs(slice_by[[k]])
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
expect_equal(
sb_x(x, slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[seq(seq_start[i], seq_end[j], seq_by)]
)
}
}
}
setwd("D:/D Desktop/Publications/R package squarebrackets/squarebrackets/inst/tinytest")
sys.source(file.path(getwd(), "source", "functions4testing.R"), envir = environment())
# argument i ====
x <- 1:10
slice_start <- c(
1, 2, 1-1i, 2-1i
)
seq_start <- c(
1, 2, length(x), length(x) - 1
)
slice_end <- c(
1, 2, 1-1i, 2-1i
)
seq_end <- c(
1, 2, length(x), length(x) - 1
)
slice_by <- list(
1, -1, 2, -2, NULL
)
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * abs(slice_by[[k]])
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
expect_equal(
sb_x(x, slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[seq(seq_start[i], seq_end[j], seq_by)]
) |> errorfun()
}
}
}
sys.source(file.path(getwd(), "source", "functions4testing.R"), envir = environment())
enumerate <- 0
# argument i ====
x <- 1:10
slice_start <- c(
1, 2, 1-1i, 2-1i
)
seq_start <- c(
1, 2, length(x), length(x) - 1
)
slice_end <- c(
1, 2, 1-1i, 2-1i
)
seq_end <- c(
1, 2, length(x), length(x) - 1
)
slice_by <- list(
1, -1, 2, -2, NULL
)
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * abs(slice_by[[k]])
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
expect_equal(
sb_x(x, slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[seq(seq_start[i], seq_end[j], seq_by)]
) |> errorfun()
enumerate <- enumerate + 1L
}
}
}
x <- matrix(1:20, ncol = 5)
x <- matrix(1:20, ncol = 5)
slice_start <- c(
1, 2, 1-1i, 2-1i
)
seq_start <- c(
1, 2, ncol(x), ncol(x) - 1
)
slice_end <- c(
1, 2, 1-1i, 2-1i
)
seq_end <- c(
1, 2, ncol(x), ncol(x) - 1
)
slice_by <- list(
1, -1, 2, -2, NULL
)
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * abs(slice_by[[k]])
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
expect_equal(
sb_x(x, col = slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[, seq(seq_start[i], seq_end[j], seq_by)]
) |> errorfun()
enumerate <- enumerate + 1L
}
}
}
expect_equal(
sb_x(x, col = slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[, seq(seq_start[i], seq_end[j], seq_by), drop = FALSE]
) |> errorfun()
x <- matrix(1:50, ncol = 10)
slice_start <- c(
1, 2, 1-1i, 2-1i
)
seq_start <- c(
1, 2, ncol(x), ncol(x) - 1
)
slice_end <- c(
1, 2, 1-1i, 2-1i
)
seq_end <- c(
1, 2, ncol(x), ncol(x) - 1
)
slice_by <- list(
1, -1, 2, -2, NULL
)
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * abs(slice_by[[k]])
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
expect_equal(
sb_x(x, col = slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[, seq(seq_start[i], seq_end[j], seq_by), drop = FALSE]
) |> errorfun()
enumerate <- enumerate + 1L
}
}
}
x <- data.frame(a = 1:10, by = letters[1:10])
slice_start <- c(
1, 2, 1-1i, 2-1i
)
seq_start <- c(
1, 2, nrow(x), nrow(x) - 1
)
slice_end <- c(
1, 2, 1-1i, 2-1i
)
seq_end <- c(
1, 2, nrow(x), nrow(x) - 1
)
slice_by <- list(
1, -1, 2, -2, NULL
)
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * abs(slice_by[[k]])
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
expect_equal(
sb_x(x, col = slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[, seq(seq_start[i], seq_end[j], seq_by), drop = FALSE]
) |> errorfun()
enumerate <- enumerate + 1L
}
}
}
expect_equal(
sb2_x(x, col = slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[, seq(seq_start[i], seq_end[j], seq_by), drop = FALSE]
) |> errorfun()
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * abs(slice_by[[k]])
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
expect_equal(
sb2_x(x, col = slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[, seq(seq_start[i], seq_end[j], seq_by), drop = FALSE]
) |> errorfun()
enumerate <- enumerate + 1L
}
}
}
x <- data.frame(a = 1:10, by = letters[1:10])
slice_start <- c(
1, 2, 1-1i, 2-1i
)
seq_start <- c(
1, 2, nrow(x), nrow(x) - 1
)
slice_end <- c(
1, 2, 1-1i, 2-1i
)
seq_end <- c(
1, 2, nrow(x), nrow(x) - 1
)
slice_by <- list(
1, -1, 2, -2, NULL
)
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * abs(slice_by[[k]])
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
expect_equal(
sb2_x(x, row = slice(slice_start[i], slice_end[j], slice_by[[k]])),
x[seq(seq_start[i], seq_end[j], seq_by), drop = FALSE, ]
) |> errorfun()
enumerate <- enumerate + 1L
}
}
}
x[seq(seq_start[i], seq_end[j], seq_by), drop = FALSE, ]
sb2_x(x, row = slice(slice_start[i], slice_end[j], slice_by[[k]]))
expect_equal(
sb2_x(x, row = slice(slice_start[i], slice_end[j], slice_by[[k]])),
collapse::ss(x, j = seq(seq_start[i], seq_end[j], seq_by))
) |> errorfun()
expect_equal(
sb2_x(x, row = slice(slice_start[i], slice_end[j], slice_by[[k]])),
collapse::ss(x, i = seq(seq_start[i], seq_end[j], seq_by))
) |> errorfun()
x <- data.frame(a = 1:10, b = letters[1:10])
slice_start <- c(
1, 2, 1-1i, 2-1i
)
seq_start <- c(
1, 2, nrow(x), nrow(x) - 1
)
slice_end <- c(
1, 2, 1-1i, 2-1i
)
seq_end <- c(
1, 2, nrow(x), nrow(x) - 1
)
slice_by <- list(
1, -1, 2, -2, NULL
)
for(i in seq_along(slice_start)) {
for(j in seq_along(slice_end)) {
for(k in seq_along(slice_by)) {
if(!is.null(slice_by[[k]])) {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1) * abs(slice_by[[k]])
} else {
seq_by <- ifelse(seq_start[i] > seq_end[j], -1, 1)
}
expect_equal(
sb2_x(x, row = slice(slice_start[i], slice_end[j], slice_by[[k]])),
collapse::ss(x, i = seq(seq_start[i], seq_end[j], seq_by))
) |> errorfun()
enumerate <- enumerate + 1L
}
}
}
