<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Convert Subscripts to Coordinates, Coordinates to Flat Indices, and Vice-Versa — sub2ind • squarebrackets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto_Serif-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Convert Subscripts to Coordinates, Coordinates to Flat Indices, and Vice-Versa — sub2ind"><meta name="description" content="These functions convert a list of integer subscripts to an integer matrix of coordinates,
an integer matrix of coordinates to an integer vector of flat indices,
and vice-versa.
Inspired by the sub2ind function from 'MatLab'.
sub2coord()
converts a list of integer subscripts to an integer matrix of coordinates.
coord2ind()
converts an integer matrix of coordinates to an integer vector of flat indices.
ind2coord()
converts an integer vector of flat indices to an integer matrix of coordinates.
coord2sub()
converts an integer matrix of coordinates to a list of integer subscripts;
it performs a very simple (one might even say naive) conversion.
sub2ind()
is a faster and more memory efficient version of
coord2ind(sub2coord(sub, x.dims), x.dims)


All of these functions are written to be memory-efficient.
The coord2ind() is thus the opposite of arrayInd,
and ind2coord is merely a convenient wrapper around arrayInd.

Note that the equivalent to the sub2ind function from 'MatLab'
is actually the coord2ind() function here.  "><meta property="og:description" content="These functions convert a list of integer subscripts to an integer matrix of coordinates,
an integer matrix of coordinates to an integer vector of flat indices,
and vice-versa.
Inspired by the sub2ind function from 'MatLab'.
sub2coord()
converts a list of integer subscripts to an integer matrix of coordinates.
coord2ind()
converts an integer matrix of coordinates to an integer vector of flat indices.
ind2coord()
converts an integer vector of flat indices to an integer matrix of coordinates.
coord2sub()
converts an integer matrix of coordinates to a list of integer subscripts;
it performs a very simple (one might even say naive) conversion.
sub2ind()
is a faster and more memory efficient version of
coord2ind(sub2coord(sub, x.dims), x.dims)


All of these functions are written to be memory-efficient.
The coord2ind() is thus the opposite of arrayInd,
and ind2coord is merely a convenient wrapper around arrayInd.

Note that the equivalent to the sub2ind function from 'MatLab'
is actually the coord2ind() function here.  "></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">squarebrackets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a_benchmarks_x.html">Benchmarks - sb_x</a></li>
    <li><a class="dropdown-item" href="../articles/b_benchmarks_tf.html">Benchmarks - transform operations</a></li>
    <li><a class="dropdown-item" href="../articles/c_benchmarks_lst.html">Benchmarks - Vectorized Recursive Subset Operations On Nested Lists</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tony-aw/squarebrackets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Convert Subscripts to Coordinates, Coordinates to Flat Indices, and Vice-Versa</h1>
      <small class="dont-index">Source: <a href="https://github.com/tony-aw/squarebrackets/blob/HEAD/R/sub2ind.R" class="external-link"><code>R/sub2ind.R</code></a></small>
      <div class="d-none name"><code>sub2ind.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions convert a list of integer subscripts to an integer matrix of coordinates,
an integer matrix of coordinates to an integer vector of flat indices,
and vice-versa. <br>
Inspired by the <code>sub2ind</code> function from 'MatLab'. <br></p><ul><li><p><code>sub2coord()</code>
converts a list of integer subscripts to an integer matrix of coordinates.</p></li>
<li><p><code>coord2ind()</code>
converts an integer matrix of coordinates to an integer vector of flat indices.</p></li>
<li><p><code>ind2coord()</code>
converts an integer vector of flat indices to an integer matrix of coordinates.</p></li>
<li><p><code>coord2sub()</code>
converts an integer matrix of coordinates to a list of integer subscripts; <br>
it performs a very simple (one might even say naive) conversion. <br></p></li>
<li><p><code>sub2ind()</code>
is a faster and more memory efficient version of <br><code>coord2ind(sub2coord(sub, x.dims), x.dims)</code> <br><br></p></li>
</ul><p>All of these functions are written to be memory-efficient. <br>
The <code>coord2ind()</code> is thus the opposite of <a href="https://rdrr.io/r/base/which.html" class="external-link">arrayInd</a>,
and <code>ind2coord</code> is merely a convenient wrapper around <a href="https://rdrr.io/r/base/which.html" class="external-link">arrayInd</a>. <br><br>
Note that the equivalent to the <code>sub2ind</code> function from 'MatLab'
is actually the <code>coord2ind()</code> function here. <br><br></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sub2coord</span><span class="op">(</span><span class="va">sub</span>, <span class="va">x.dim</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">coord2sub</span><span class="op">(</span><span class="va">coord</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">coord2ind</span><span class="op">(</span><span class="va">coord</span>, <span class="va">x.dim</span>, checks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ind2coord</span><span class="op">(</span><span class="va">ind</span>, <span class="va">x.dim</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sub2ind</span><span class="op">(</span><span class="va">sub</span>, <span class="va">x.dim</span>, checks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sub">sub<a class="anchor" aria-label="anchor" href="#arg-sub"></a></dt>
<dd><p>a list of integer subscripts. <br>
The first element of the list corresponds to the first dimension (rows),
the second element to the second dimensions (columns),
etc. <br>
The length of <code>sub</code> must be equal to the length of <code>x.dim</code>. <br>
One cannot give an empty subscript;
instead fill in something like <code>seq_len(dim(x)[margin])</code>. <br>
NOTE: The <code>coord2sub()</code> function does not support duplicate subscripts.</p></dd>


<dt id="arg-x-dim">x.dim<a class="anchor" aria-label="anchor" href="#arg-x-dim"></a></dt>
<dd><p>an integer vector giving the dimensions of the array in question. I.e. <code>dim(x)</code>.</p></dd>


<dt id="arg-coord">coord<a class="anchor" aria-label="anchor" href="#arg-coord"></a></dt>
<dd><p>an integer matrix, giving the coordinate indices (subscripts) to convert. <br>
Each row is an index, and each column is the dimension. <br>
The first columns corresponds to the first dimension,
the second column to the second dimensions,
etc. <br>
The number of columns of <code>coord</code> must be equal to the length of <code>x.dim</code>. <br></p></dd>


<dt id="arg-checks">checks<a class="anchor" aria-label="anchor" href="#arg-checks"></a></dt>
<dd><p>Boolean, indicating if arguments checks should be performed. <br>
Defaults to <code>TRUE</code>. <br>
Can be set to <code>FALSE</code> for minor speed improvements. <br><img src="figures/for_performance-set_to_FALSE-red.svg" alt="[for performance: set to FALSE]"><br></p></dd>


<dt id="arg-ind">ind<a class="anchor" aria-label="anchor" href="#arg-ind"></a></dt>
<dd><p>an integer vector, giving the flat position indices to convert.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For <code>sub2coord()</code> and <code>ind2coord()</code>: <br>
Returns an integer matrix of coordinates
(with properties as described in argument <code>coord</code>). <br><br>
For <code>coord2ind()</code>: <br>
Returns an numeric vector of flat indices
(with properties as described in argument <code>ind</code>). <br><br>
For <code>coord2sub()</code>: <br>
Returns a list of integer subscripts
(with properties as described in argument <code>sub</code>) <br><br>
For <code>sub2ind()</code>: <br>
Returns an integer vector of flat indices(if <code>prod(x.dim) &lt; (2^31 - 1)</code>),
or an numeric vector of flat indices (if <code>prod(x.dim) &gt;= (2^31 - 1)</code>). <br><br></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The base S3 vector and array classes in 'R' use the standard Linear Algebraic convention,
as in academic fields like Mathematics and Statistics,
in the following sense: <br></p><ul><li><p>vectors are <b>column</b> vectors (i.e. vertically aligned vectors);</p></li>
<li><p>index counting starts at <code>1</code>;</p></li>
<li><p>rows are the first dimension/subscript, columns are the second dimension/subscript, etc.</p></li>
</ul><p>Thus, the orientation of flat indices in, for example,
a 4-rows-by-5-columns matrix, is as follows:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">5</span>    <span class="dv">9</span>   <span class="dv">13</span>   <span class="dv">17</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">6</span>   <span class="dv">10</span>   <span class="dv">14</span>   <span class="dv">18</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>[<span class="dv">3</span>,]    <span class="dv">3</span>    <span class="dv">7</span>   <span class="dv">11</span>   <span class="dv">15</span>   <span class="dv">19</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>[<span class="dv">4</span>,]    <span class="dv">4</span>    <span class="dv">8</span>   <span class="dv">12</span>   <span class="dv">16</span>   <span class="dv">20</span></span></code></pre><p></p></div>
<p>So in a 4 by 5 matrix, subscript <code>[1, 2]</code> corresponds to flat index <code>5</code>. <br>
Array subscripting in 'squarebrackets' also follows this standard convention. <br><br></p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>These functions were not specifically designed for duplicate indices per-sé. <br>
For efficiency, they do not check for duplicate indices either. <br></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x.dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x.len</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="va">x.dim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">x.len</span>, <span class="va">x.dim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coord</span> <span class="op">&lt;-</span> <span class="fu">sub2coord</span><span class="op">(</span><span class="va">sub</span>, <span class="va">x.dim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">coord</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    4    3    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    3    3    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    4    2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    3    2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]    4    3    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]    3    3    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,]    4    2    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8,]    3    2    3</span>
<span class="r-in"><span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu">coord2ind</span><span class="op">(</span><span class="va">coord</span>, <span class="va">x.dim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ind</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 124 123 114 113 224 223 214 213</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">coord2</span> <span class="op">&lt;-</span> <span class="fu">ind2coord</span><span class="op">(</span><span class="va">ind</span>, <span class="va">x.dim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">coord</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    4    3    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    3    3    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    4    2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    3    2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]    4    3    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]    3    3    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,]    4    2    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8,]    3    2    3</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">coord</span> <span class="op">==</span> <span class="va">coord2</span><span class="op">)</span> <span class="co"># TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">sub2</span> <span class="op">&lt;-</span> <span class="fu">coord2sub</span><span class="op">(</span><span class="va">coord2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, \<span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="va">sub2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="va">sub</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tony Wilkes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

